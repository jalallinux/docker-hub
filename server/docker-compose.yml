# For more information: https://laravel.com/docs/sail
version: '3'
services:

    pgsql:
        image: bitnami/postgresql:14
        ports:
            - '5432:5432'
        environment:
            POSTGRESQL_POSTGRES_PASSWORD: 'sXQHNK59FYke'
            POSTGRESQL_USERNAME: 'poostgres'
            POSTGRESQL_PASSWORD: 'poostgres'
        networks:
            tick:
                ipv4_address: 10.0.1.3
        volumes:
            - 'postgres_data:/bitnami/postgresql'
        healthcheck:
            test: ["CMD", "pg_isready", "-q", "-d", "postgres", "-U", "postgres"]
            retries: 3
            timeout: 5s

    redis:
        image: bitnami/redis:7.0
        ports:
            - '6379:6379'
        environment:
            ALLOW_EMPTY_PASSWORD: 'no'
            REDIS_PASSWORD: 'sXQHNK59FYke'
            REDIS_DISABLE_COMMANDS: 'FLUSHDB,FLUSHALL'
        networks:
            tick:
                ipv4_address: 10.0.1.4
        volumes:
            - 'redis_data:/bitnami/redis/data'
        healthcheck:
            test: ["CMD", "redis-cli", "ping"]
            retries: 3
            timeout: 5s

networks:
    tick:
        driver: bridge
        ipam:
            config:
                - subnet: 10.0.1.0/16

volumes:
    postgres_data:
        driver: local
    redis_data:
        driver: local
